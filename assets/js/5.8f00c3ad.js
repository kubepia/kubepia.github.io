(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{315:function(t,e,s){t.exports=s.p+"assets/img/2020-05-26-00-11-22.5bdcf8d0.png"},316:function(t,e,s){t.exports=s.p+"assets/img/2020-05-26-00-16-42.46b727d5.png"},317:function(t,e,s){t.exports=s.p+"assets/img/2020-05-26-00-19-40.84fc12f3.png"},318:function(t,e,s){t.exports=s.p+"assets/img/2020-05-26-00-20-39.2410d006.png"},319:function(t,e,s){t.exports=s.p+"assets/img/2020-05-26-00-26-54.85c71579.png"},320:function(t,e,s){t.exports=s.p+"assets/img/2020-05-26-00-28-10.68f5dbe3.png"},321:function(t,e,s){t.exports=s.p+"assets/img/2020-05-26-00-33-34.01d8825a.png"},322:function(t,e,s){t.exports=s.p+"assets/img/2020-05-26-00-38-40.eab863e5.png"},323:function(t,e,s){t.exports=s.p+"assets/img/2020-05-26-00-46-55.c7ff85ed.png"},324:function(t,e,s){t.exports=s.p+"assets/img/2020-05-26-00-47-13.4edb84e9.png"},325:function(t,e,s){t.exports=s.p+"assets/img/2020-05-26-00-48-58.762bf86b.png"},371:function(t,e,s){"use strict";s.r(e);var a=s(17),r=Object(a.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"ocp-ocp-설치"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ocp-ocp-설치"}},[t._v("#")]),t._v(" OCP-OCP 설치")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TASK DESCRIPTION")]),t._v(" "),a("p",[t._v("OCP를 설치합니다."),a("br"),t._v("\n※ "),a("strong",[t._v("중요: OCP설치 후 24시간이상 실행 필요")]),a("br"),t._v("\nOCP를 최초 설치할때는 내부 TLS통신을 위해 임시 key파일을 사용합니다."),a("br"),t._v("\n이 TLS Key파일은 설치 후 24시간내에 자동으로 갱신됩니다."),a("br"),t._v("\n따라서 24시간동안은 Master/Worker Node를 정지시키면 안됩니다."),a("br"),t._v("\n(참고: 잠깐 내렸다 올리는 건 괜찮습니다.)")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#bootstrap-master-node-vm-부팅"}},[t._v("bootstrap, Master node VM 부팅")])]),a("li",[a("a",{attrs:{href:"#bootstrap-console-log-보기"}},[t._v("bootstrap console log 보기")])]),a("li",[a("a",{attrs:{href:"#설치완료-여부-확인"}},[t._v("설치완료 여부 확인")])]),a("li",[a("a",{attrs:{href:"#master-node-준비여부-확인"}},[t._v("Master node 준비여부 확인")])]),a("li",[a("a",{attrs:{href:"#worker-node-vm-부팅"}},[t._v("Worker Node VM 부팅")])]),a("li",[a("a",{attrs:{href:"#worker-node-승인"}},[t._v("Worker node 승인")])]),a("li",[a("a",{attrs:{href:"#최종-확인"}},[t._v("최종 확인")])])])]),a("p")]),t._v(" "),a("h2",{attrs:{id:"bootstrap-master-node-vm-부팅"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bootstrap-master-node-vm-부팅"}},[t._v("#")]),t._v(" bootstrap, Master node VM 부팅")]),t._v(" "),a("p",[t._v("VM을 부팅시키면 ignition설정에 의해 설치가 자동으로 시작됩니다."),a("br"),t._v("\nbootstrap VM부터 먼저 시작합니다."),a("br"),t._v("\n조금 이따가 Master VM들을 부팅합니다."),a("br"),t._v("\nWorker VM들도 같이 부팅해도 되나, 실패할수도 있으므로 Master node가 정상적으로 설치된 후에 시작하십시오."),a("br"),t._v(" "),a("img",{attrs:{src:s(315),alt:""}})]),t._v(" "),a("h2",{attrs:{id:"bootstrap-console-log-보기"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bootstrap-console-log-보기"}},[t._v("#")]),t._v(" bootstrap console log 보기")]),t._v(" "),a("p",[t._v("bootstrap으로 접근하여 설치 로그를 봅니다.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("RHCOS를 사용하는 VM들은 'core'라는 user로 로그인해야 합니다.  \n$ ssh core@<bootstrap IP>\n$ journalctl -b -f -u bootkube.service\n")])])]),a("p",[a("img",{attrs:{src:s(316),alt:""}})]),t._v(" "),a("p",[t._v("로그인 후 안내 메시지에 나오는 journalctl명령을 실행합니다."),a("br"),t._v(" "),a("img",{attrs:{src:s(317),alt:""}})]),t._v(" "),a("p",[t._v("처음에는 에러 메시지가 매우 많이 나옵니다."),a("br"),t._v(" "),a("img",{attrs:{src:s(318),alt:""}})]),t._v(" "),a("p",[t._v("계속 기다리면 에러 메시지가 없어지고 설치가 되는것을 확인할 수 있습니다."),a("br"),t._v(" "),a("img",{attrs:{src:s(319),alt:""}})]),t._v(" "),a("h2",{attrs:{id:"설치완료-여부-확인"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#설치완료-여부-확인"}},[t._v("#")]),t._v(" 설치완료 여부 확인")]),t._v(" "),a("p",[t._v("설치는 약 15~20여분정도 소요됩니다."),a("br"),t._v("\n설치완료 여부는 아래 명령으로 확인할 수 있습니다.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ openshift-install --dir=<installation_directory> wait-for bootstrap-complete --log-level=info\n")])])]),a("p",[a("img",{attrs:{src:s(320),alt:""}})]),t._v(" "),a("h2",{attrs:{id:"master-node-준비여부-확인"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#master-node-준비여부-확인"}},[t._v("#")]),t._v(" Master node 준비여부 확인")]),t._v(" "),a("p",[t._v("kubeconfig파일을 [HOME]/.kube/config로 복사한 후 node의 상태를 확인합니다.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ mkdir ~/.kube\n$ cp <intallation_directory>/auth/kubeconfig ~/.kube/config\n$ oc get nodes\n")])])]),a("p",[a("img",{attrs:{src:s(321),alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:s(322),alt:""}})]),t._v(" "),a("h2",{attrs:{id:"worker-node-vm-부팅"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#worker-node-vm-부팅"}},[t._v("#")]),t._v(" Worker Node VM 부팅")]),t._v(" "),a("p",[t._v("Worker node VM들을 부팅합니다.")]),t._v(" "),a("h2",{attrs:{id:"worker-node-승인"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#worker-node-승인"}},[t._v("#")]),t._v(" Worker node 승인")]),t._v(" "),a("p",[t._v("install-config.yaml에 worker node수를 지정하면 최초 설치시에는 자동으로 worker node가 추가됩니다."),a("br"),t._v("\n추가된 Worker node들을 cluster에 join시키기 위해서는 CSR(Certificate Signing Requests)를 승인해야 합니다.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Worker node들의 상태가 'Not Ready'로 보임   \n$ oc get nodes\n\nCSR승인대기 중인 node 리스트 보기  \n$ oc get csr\n\nCSR승인\n$ oc adm certificate approve <csr_name> \n\n모든 CSR승인\n$ oc get csr -o go-template='{{range .items}}{{if not .status}}{{.metadata.name}}{{\"\\n\"}}{{end}}{{end}}' | xargs oc adm certificate approve\n")])])]),a("p",[a("img",{attrs:{src:s(323),alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:s(324),alt:""}})]),t._v(" "),a("h2",{attrs:{id:"최종-확인"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#최종-확인"}},[t._v("#")]),t._v(" 최종 확인")]),t._v(" "),a("p",[t._v("node들의 상태를 확인합니다."),a("br"),t._v(" "),a("img",{attrs:{src:s(325),alt:""}})]),t._v(" "),a("p",[t._v("OCP Web console로 로그인합니다.")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("항목")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("설명")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("예")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("주소")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("https://console-openshift-console.apps.[cluster name].[base domain]")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("https://console-openshift-console.apps.hcp.kubepia.com")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("username")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("kubeadmin")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("-")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("password")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("bastion VM의 [install directory]/config/auth/kubeadmin-password파일 참조")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("생략")])])])]),t._v(" "),a("hr"),t._v(" "),a("disqus")],1)}),[],!1,null,null,null);e.default=r.exports}}]);