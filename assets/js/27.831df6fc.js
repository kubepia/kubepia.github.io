(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{586:function(t,s,a){t.exports=a.p+"assets/img/2020-06-07-20-22-51.6bc291a8.png"},624:function(t,s,a){"use strict";a.r(s);var r=a(25),e=Object(r.a)({},(function(){var t=this,s=t.$createElement,r=t._self._c||s;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"mirror-registry"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mirror-registry"}},[t._v("#")]),t._v(" Mirror registry")]),t._v(" "),r("div",{staticClass:"custom-block tip"},[r("p",{staticClass:"custom-block-title"},[t._v("Ref")]),t._v(" "),r("p",[t._v("Redhat Document : "),r("a",{attrs:{href:"https://docs.openshift.com/container-platform/4.4/installing/install_config/installing-restricted-networks-preparations.html",target:"_blank",rel:"noopener noreferrer"}},[r("OutboundLink")],1)])]),t._v(" "),r("h2",{attrs:{id:"preparing-the-bastion-host"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#preparing-the-bastion-host"}},[t._v("#")]),t._v(" Preparing the bastion host")]),t._v(" "),r("blockquote",[r("p",[t._v("설치에 필요한 Container를 Mirror하는데 인터넷이 연결되는 서버가 필요하며, "),r("br"),t._v("\nMirror된 이후 내부 서버와도 연결이 가능해야 합니다.")])]),t._v(" "),r("ul",[r("li",[t._v("필요 software : oc cli, podman, httpd-tools")]),t._v(" "),r("li",[t._v("directory : /opt/registry/{auth,certs,data}")]),t._v(" "),r("li",[t._v("ssh key : 사설 인증서 사용 가능( container pull 등에 TLS 인증 해제 설정이 필요함)"),r("div",{staticClass:"language-shell extra-class"},[r("pre",{pre:!0,attrs:{class:"language-shell"}},[r("code",[r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /opt/registry/certs\nopenssl req -newkey rsa:4096 -nodes -sha256 -keyout domain.key -x509 -days "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("365")]),t._v(" -out domain.crt\n")])])])])]),t._v(" "),r("h2",{attrs:{id:"mirroring"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mirroring"}},[t._v("#")]),t._v(" Mirroring")]),t._v(" "),r("h3",{attrs:{id:"install-sw"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#install-sw"}},[t._v("#")]),t._v(" Install SW")]),t._v(" "),r("ol",[r("li",[t._v("oc cli : 작업 환경에 맞는 "),r("a",{attrs:{href:"https://mirror.openshift.com/pub/openshift-v4/clients/ocp/4.4.7/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ocp 4.4.7 client"),r("OutboundLink")],1),t._v("를 다운로드 받고 압축을 푼다.\n"),r("img",{attrs:{src:a(586),alt:""}})]),t._v(" "),r("li",[t._v("install podman : container 작업(pull/push/run etc)을 위한 tool")]),t._v(" "),r("li",[t._v("install httpd-tools : container registry secret을 httppwd 기본인증으로 생성하기 위한 Tool(다른 tool 사용 가능)"),r("div",{staticClass:"language-shell extra-class"},[r("pre",{pre:!0,attrs:{class:"language-shell"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y podman httpd-tools\n\n")])])])])]),t._v(" "),r("h3",{attrs:{id:"mirror-registry-실행"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mirror-registry-실행"}},[t._v("#")]),t._v(" Mirror Registry 실행")]),t._v(" "),r("ol",[r("li",[t._v("Containre Registry를 위한 SSL Keys into "),r("strong",[t._v("/opt/registry/certs")])]),t._v(" "),r("li",[t._v("Container Resgistry ID/Password 파일 생성 : 예) admin|passw0rd"),r("div",{staticClass:"language-shell extra-class"},[r("pre",{pre:!0,attrs:{class:"language-shell"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# htpasswd -bBc /opt/registry/auth/htpasswd admin passw0rd")]),t._v("\n")])])])]),t._v(" "),r("li",[t._v("Run Mirror-Registry 실행 : OCP 설치를 위한 Container를 Mirror 하기 위한 Registry를 실행한다. 예) host: https://registry.kubepia.net:5000"),r("div",{staticClass:"language-shell extra-class"},[r("pre",{pre:!0,attrs:{class:"language-shell"}},[r("code",[t._v("podman run --name mirror-registry -p "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),t._v(":5000 "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -v /opt/registry/data:/var/lib/registry:z "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -v /opt/registry/auth:/auth:z "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -e "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"REGISTRY_AUTH=htpasswd"')]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -e "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm"')]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -e "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("REGISTRY_AUTH_HTPASSWD_PATH")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/auth/htpasswd "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -v /opt/registry/certs:/certs:z "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -e "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("REGISTRY_HTTP_TLS_CERTIFICATE")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/certs/domain.crt "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -e "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("REGISTRY_HTTP_TLS_KEY")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/certs/domain.key "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -e "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("REGISTRY_COMPATIBILITY_SCHEMA1_ENABLED")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d docker.io/library/registry:2\n")])])])]),t._v(" "),r("li",[t._v("다른 VM에서 접근 테스트: 사성 인증서를 적용한 경우 -k 옵션 사용")])]),t._v(" "),r("div",{staticClass:"language-shell extra-class"},[r("pre",{pre:!0,attrs:{class:"language-shell"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# curl -u admin:passw0rd  -k https://registry.kubepia.net:5000/v2/_catalog")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"repositories"')]),t._v(":"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),r("ol",{attrs:{start:"5"}},[r("li",[t._v("(Option) 사설인증서를 사용한 경우 작업 VM에 Trust 설정"),r("div",{staticClass:"language-shell extra-class"},[r("pre",{pre:!0,attrs:{class:"language-shell"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cp /opt/registry/certs/domain.crt /etc/pki/ca-trust/source/anchors/")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# update-ca-trust")]),t._v("\n")])])])])]),t._v(" "),r("h3",{attrs:{id:"pull-secret-설정"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pull-secret-설정"}},[t._v("#")]),t._v(" Pull secret 설정")]),t._v(" "),r("ol",[r("li",[t._v("Download Pull secret from "),r("a",{attrs:{href:"https://cloud.redhat.com/openshift/install/pull-secret",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redhat login required"),r("OutboundLink")],1),r("div",{staticClass:"language-json extra-class"},[r("pre",{pre:!0,attrs:{class:"language-json"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auths"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"cloud.openshift.com"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auth"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"b3BlbnNo..."')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"email"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"you@example.com"')]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"quay.io"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auth"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"b3BlbnNo..."')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"email"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"you@example.com"')]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"registry.connect.redhat.com"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auth"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NTE3Njg5Nj..."')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"email"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"you@example.com"')]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"registry.redhat.io"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auth"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NTE3Njg5Nj..."')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"email"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"you@example.com"')]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),r("li",[t._v("Mirror Registry Secret 생성(base64 encoding)"),r("div",{staticClass:"language-shell extra-class"},[r("pre",{pre:!0,attrs:{class:"language-shell"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# echo -n 'admin:passw0rd' | base64 -w0")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("YWRtaW46cGFzc3cwcmQ")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n")])])])]),t._v(" "),r("li",[t._v("Mirror Registry Secret 추가 : /opt/registry/certs/pull-secret.json"),r("div",{staticClass:"language-json extra-class"},[r("pre",{pre:!0,attrs:{class:"language-json"}},[r("code",[r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auths"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"cloud.openshift.com"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auth"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"b3BlbnNo..."')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"email"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"you@example.com"')]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"quay.io"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auth"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"b3BlbnNo..."')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"email"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"you@example.com"')]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"registry.connect.redhat.com"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auth"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NTE3Njg5Nj..."')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"email"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"you@example.com"')]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"registry.redhat.io"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auth"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NTE3Njg5Nj..."')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"email"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"you@example.com"')]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"registry.kubepia.net:5000"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auth"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"YWRtaW46cGFzc3cwcmQ"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),r("span",{pre:!0,attrs:{class:"token property"}},[t._v('"email"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"you@example.com"')]),t._v("\n     "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])]),t._v(" "),r("h3",{attrs:{id:"mirroring-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mirroring-2"}},[t._v("#")]),t._v(" Mirroring")]),t._v(" "),r("ol",[r("li",[t._v("환경변수 설정 :\n"),r("ol",[r("li",[t._v("OCP_RELEASE : 설치할 OCP 버전 지정 예) 4.4.7. 다음 싸이트에서 선택 "),r("a",{attrs:{href:"https://quay.io/repository/openshift-release-dev/ocp-release?tab=tags",target:"_blank",rel:"noopener noreferrer"}},[t._v("Repo list"),r("OutboundLink")],1)]),t._v(" "),r("li",[t._v("LOCAL_REGISTRY : Mirror Registry URL 예) registry.kubepia.net:5000")]),t._v(" "),r("li",[t._v("LOCAL_REPOSITORY : Registry Repository Name 예)ocp4/openshift4")]),t._v(" "),r("li",[t._v("PRODUCT_REPO : predefined 예) openshift-release-dev")]),t._v(" "),r("li",[t._v("LOCAL_SECRET_JSON : pull secret file path 예) /opt/registry/certs/pull-secret.json")]),t._v(" "),r("li",[t._v("RELEASE_NAME: predefined 예)ocp-release")])]),t._v(" "),r("div",{staticClass:"language-shell extra-class"},[r("pre",{pre:!0,attrs:{class:"language-shell"}},[r("code",[r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("OCP_RELEASE")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4.4.6-x86_64"')]),t._v(" \n"),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("LOCAL_REGISTRY")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'registry.kubepia.net:5000'")]),t._v(" \n"),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("LOCAL_REPOSITORY")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ocp4/openshift4'")]),t._v(" \n"),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PRODUCT_REPO")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'openshift-release-dev'")]),t._v(" \n"),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("LOCAL_SECRET_JSON")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/opt/registry/certs/pull-secret.json'")]),t._v(" \n"),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("RELEASE_NAME")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ocp-release"')]),t._v("\n")])])])]),t._v(" "),r("li",[t._v("Run mirror : oc adm"),r("div",{staticClass:"language-shell extra-class"},[r("pre",{pre:!0,attrs:{class:"language-shell"}},[r("code",[t._v("oc adm -a "),r("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${LOCAL_SECRET_JSON}")]),t._v(" release mirror "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n   --from"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("quay.io/"),r("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${PRODUCT_REPO}")]),t._v("/"),r("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${RELEASE_NAME}")]),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${OCP_RELEASE}")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n   --to"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${LOCAL_REGISTRY}")]),t._v("/"),r("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${LOCAL_REPOSITORY}")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n   --to-release-image"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${LOCAL_REGISTRY}")]),t._v("/"),r("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${LOCAL_REPOSITORY}")]),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${OCP_RELEASE}")]),t._v(" \n")])])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);